---
title: "Homework"
output: html_notebook
---

```{r}
library(tidyverse)
library(janitor)
library(GGally)
library(modelr)
library(ggfortify)
```


```{r}
housing_prices <- read_csv("data/housing_prices.csv")
```

```{r}
housing_prices %>% 
ggpairs(columns = c("total_rooms", "total_bedrooms"))
```

Very strong positive linear correlation of r = 0.934


```{r}
housing_trimmed <- housing_prices %>% 
  select(-total_bedrooms)
```

```{r}
ggpairs(housing_trimmed)
```



median_house_value, median_income = 0.643
median_house_value, total_rooms = 0.143

```{r}
housing_trimmed %>% 
  ggplot()+
  aes(x = median_income,
      y = median_house_value) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```


```{r}
housing_trimmed %>% 
  ggplot()+
  aes(x = total_rooms,
      y = median_house_value) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```


```{r}
housing_trimmed %>% 
distinct(ocean_proximity
         )
```

4 dummy variables


```{r}
model <- lm(formula = median_house_value ~ median_income,
            data = housing_trimmed)
```

```{r}
autoplot(model)
```




```{r}
summary(model)
```

```{r}
model_2 <- lm(median_house_value ~ median_income + housing_median_age,
              data = housing_trimmed)
```


```{r}
autoplot(model_2)
```

```{r}
summary(model_2
        )
```

Both median_income, and housing_median_age are significant in this model.

If median income increases by 10000 USD, the median_house_value increases by
42420, if everything else stays the same

If housing_median_age increases by 1 then median_house_value increased by 1567.98
if everything else stays the same.
